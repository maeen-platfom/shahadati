# نظام الأرشيف - منصة شهاداتي
# Archive System - Shahadati Platform

نظام أرشيف شامل ومتقدم للشهادات والبيانات في منصة شهاداتي، يوفر إمكانيات الأرشفة التلقائية واليدوية، الضغط والتحسين، والاستعادة الآمنة للبيانات.

## الميزات الرئيسية
### Main Features

### 📁 إدارة الأرشيف
- أرشفة تلقائية للشهادات الأقدم من فترة محددة
- أرشفة يدوية حسب معايير مخصصة
- ضغط البيانات لتوفير مساحة التخزين
- تتبع حالة عمليات الأرشيف

### 🔄 استعادة البيانات
- استعادة الملفات المؤرشفة بسهولة
- بحث متقدم في الملفات المؤرشفة
- معاينة البيانات قبل الاستعادة
- استعادة جماعية أو فردية

### ⚙️ إعدادات متقدمة
- تخصيص فترة الأرشفة التلقائية
- تحديد أنواع الملفات المسموحة
- إعدادات مستوى الضغط
- النسخ الاحتياطي التلقائي

### 📊 التقارير والإحصائيات
- إحصائيات مفصلة عن الأرشيف
- تقارير دورية
- تتبع أداء العمليات
- تحليل استخدام مساحة التخزين

### 🛠️ التنظيف والصيانة
- تنظيف الأرشيفات القديمة تلقائياً
- حذف البيانات المنتهية الصلاحية
- تحسين أداء قاعدة البيانات

## هيكل الملفات
### File Structure

```
shahadati/
├── types/
│   └── archive.ts                    # تعريفات TypeScript
├── lib/
│   └── utils/
│       └── archive.ts               # دوال الأدوات المساعدة
├── components/
│   └── admin/
│       ├── ArchiveManager.tsx       # مدير الأرشيف الرئيسي
│       ├── ArchiveSettings.tsx      # إعدادات الأرشيف
│       ├── ArchiveHistory.tsx       # سجل الأرشيف
│       ├── ArchiveRestore.tsx       # استعادة البيانات
│       └── archive/
│           └── index.ts             # تصدير المكونات
├── app/
│   ├── admin/
│   │   └── archive/
│   │       └── page.tsx             # صفحة الأرشيف الرئيسية
│   └── api/
│       └── archive/
│           ├── route.ts             # API إدارة الأرشيف
│           ├── settings/
│           │   └── route.ts         # API الإعدادات
│           ├── logs/
│           │   └── route.ts         # API السجلات
│           ├── cleanup/
│           │   └── route.ts         # API التنظيف
│           ├── files/
│           │   └── [fileId]/
│           │       └── route.ts     # API ملفات الأرشيف
│           └── restore/
│               └── route.ts         # API الاستعادة
```

## المكونات الرئيسية
### Main Components

### 1. ArchiveManager.tsx
المكون الرئيسي لإدارة نظام الأرشيف:
- عرض الإحصائيات العامة
- عمليات الأرشفة السريعة
- إدارة الملفات المؤرشفة
- واجهة سهلة الاستخدام

### 2. ArchiveSettings.tsx
إدارة إعدادات النظام:
- الأرشفة التلقائية
- إعدادات التخزين والضغط
- الإشعارات والتنبيهات
- إعدادات الأداء المتقدمة

### 3. ArchiveHistory.tsx
تتبع عمليات الأرشيف:
- سجل مفصل لجميع العمليات
- بحث وتصفية متقدم
- إحصائيات الأداء
- تصدير التقارير

### 4. ArchiveRestore.tsx
استعادة البيانات المؤرشفة:
- بحث متقدم في الملفات
- معاينة البيانات
- استعادة جماعية أو فردية
- تتبع حالة الاستعادة

## API Routes

### /api/archive
- **GET**: الحصول على الملفات المؤرشفة مع التصفية والتقسيم
- **POST**: بدء عملية أرشفة جديدة (تلقائية أو يدوية)
- **PUT**: تحديث إعدادات الأرشيف
- **DELETE**: تنظيف الأرشيفات القديمة

### /api/archive/settings
- **GET**: الحصول على الإعدادات الحالية
- **PUT**: تحديث الإعدادات
- **POST**: إعادة تعيين للإعدادات الافتراضية
- **DELETE**: حذف الإعدادات المخصصة

### /api/archive/logs
- **GET**: الحصول على سجلات الأرشيف
- **POST**: إنشاء سجل جديد
- **PUT**: تحديث سجل موجود
- **DELETE**: حذف السجلات القديمة

### /api/archive/restore
- **POST**: بدء عملية استعادة
- **GET**: الحصول على سجلات الاستعادة

### /api/archive/files/[fileId]
- **GET**: تنزيل ملف مؤرشف
- **DELETE**: حذف ملف مؤرشف
- **POST**: معاينة ملف مؤرشف

### /api/archive/cleanup
- **POST**: تنظيف الأرشيفات القديمة
- **GET**: معلومات التنظيف (معاينة)
- **DELETE**: حذف جميع الأرشيفات

## الاستخدام
### Usage

### الأرشفة التلقائية
```javascript
// تفعيل الأرشفة التلقائية
const settings = {
  autoArchiveEnabled: true,
  archiveAfterDays: 365, // أرشفة بعد سنة
  compressionLevel: 'medium',
  retentionPeriod: 2555 // احتفاظ لمدة 7 سنوات
};

// بدء الأرشفة التلقائية
const response = await fetch('/api/archive', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ type: 'auto', settings })
});
```

### البحث في الملفات المؤرشفة
```javascript
const criteria = {
  fileName: 'شهادة',
  dataType: 'certificate',
  startDate: new Date('2024-01-01'),
  endDate: new Date('2024-12-31')
};

const response = await fetch('/api/archive/search', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(criteria)
});
```

### استعادة البيانات
```javascript
const response = await fetch('/api/archive/restore', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    fileIds: ['file1', 'file2'],
    restoreOptions: {
      overwriteExisting: false,
      createBackup: true
    }
  })
});
```

## إعدادات النظام
### System Settings

### الإعدادات الافتراضية
```javascript
const DEFAULT_ARCHIVE_SETTINGS = {
  autoArchiveEnabled: false,
  archiveAfterDays: 365,
  compressionLevel: 'medium',
  retentionPeriod: 2555, // 7 سنوات
  backupEnabled: true,
  notificationEnabled: true,
  allowedFileTypes: ['pdf', 'png', 'jpg', 'jpeg', 'doc', 'docx'],
  maxArchiveSize: 1024 * 1024 * 1024 // 1GB
};
```

### مستويات الضغط
- **منخفض (low)**: ضغط سريع، توفير مساحة أقل
- **متوسط (medium)**: توازن بين السرعة والكفاءة
- **عالي (high)**: ضغط أقوى، استهلاك وقت أكثر

### أنواع البيانات المدعومة
- `certificate`: الشهادات
- `student_data`: بيانات الطلاب
- `verification_log`: سجلات التحقق
- `activity_log`: سجلات النشاط

## الأمان والموثوقية
### Security & Reliability

### ضغط البيانات
- استخدام خوارزميات gzip و brotli
- الحفاظ على سلامة البيانات
- إنشاء checksums للتحقق

### النسخ الاحتياطي
- نسخ احتياطية تلقائية قبل الحذف
- استعادة آمنة للبيانات
- تتبع تاريخ التغييرات

### الأذونات والأمان
- التحقق من هوية المستخدم
- تسجيل جميع العمليات
- تشفير البيانات الحساسة

## أفضل الممارسات
### Best Practices

### 1. إعداد الأرشفة التلقائية
- تحديد فترة أرشفة مناسبة (سنة واحدة على الأقل)
- تفعيل النسخ الاحتياطي
- تخصيص الإشعارات

### 2. مراقبة الأداء
- مراجعة الإحصائيات بانتظام
- مراقبة استخدام مساحة التخزين
- تحسين الإعدادات حسب الحاجة

### 3. الصيانة الدورية
- تنظيف الأرشيفات القديمة
- تحديث قواعد البيانات
- فحص سلامة البيانات

### 4. الأمان
- استخدام كلمات مرور قوية
- تفعيل التحقق الثنائي
- مراجعة سجلات الوصول

## استكشاف الأخطاء
### Troubleshooting

### مشاكل شائعة وحلولها

#### 1. فشل عملية الأرشفة
- تحقق من إعدادات قاعدة البيانات
- تأكد من صحة أذونات الوصول
- راجع سجلات الأخطاء

#### 2. بطء في الاستعادة
- قلل حجم الدفعة
- تحقق من سرعة الاتصال
- استخدم التخزين المحلي

#### 3. نقص مساحة التخزين
- فعل ضغط أقوى
- احذف الأرشيفات القديمة
- وسع مساحة التخزين

## الدعم والمساعدة
### Support & Help

للحصول على الدعم أو الإبلاغ عن مشاكل:
- راجع وثائق النظام
- اتصل بفريق الدعم التقني
- أرسل تقرير مشكلة مع سجلات الأخطاء

## الترخيص
### License

هذا النظام مطور ضمن مشروع منصة شهاداتي ومحمي بحقوق الطبع والنشر.

---

*تم تطوير هذا النظام بعناية لضمان أعلى مستويات الأمان والموثوقية والكفاءة في إدارة البيانات المؤرشفة.*